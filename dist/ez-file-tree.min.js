!function(a){"use strict";a.module("ez.fileTree",[]).constant("EzFileTreeConfig",{chevronRightIconClass:"icon-chevron-right",chevronDownIconClass:"icon-chevron-down",folderIconClass:"icon-folder-close",fileIconClass:"icon-file",nameField:"name",childrenField:"children",checking:!1,multiSelect:!1}).directive("ezFileTree",["$compile","EzFileTreeConfig",function(b,c){return{restrict:"EA",link:function(d,e,f){var g,h="true"===f.checking?!0:c.checking,i="true"===f.multiSelect?!0:c.multiSelect,j=(f.nameField||c.nameField,f.childrenField||c.childrenField);d.child||(d.child=d.$eval(f.ezFileTree)),g='<ul class="ez-file-tree"><li data-ng-show="child.'+j+" && child."+j+'.length == 0">empty</li><li ng-repeat="child in child.'+j+'" data-ng-dblclick="toggle($event, child)"><div class="label-container" ng-class="{selected: child._selected}"><span class="folder-toggle" data-ng-click="toggle($event, child)"><i class="'+c.chevronRightIconClass+'" title="Open folder" data-ng-show="!child._open && isFolder(child)"></i><i class="'+c.chevronDownIconClass+'" title="Close folder" data-ng-show="child._open && isFolder(child)"></i></span>',g+='<span class="file-name" data-ng-click="select(child)">',h&&(g+='<input type="checkbox" ng-model="child._checked" ng-change="check(child)" data-ng-show="!isFolder(child)"/>'),g+='<i class="'+c.folderIconClass+'" data-ng-show="isFolder(child)"></i><i class="'+c.fileIconClass+'" data-ng-show="!isFolder(child)"></i>{{child.name}}</span></div><div class="folder-container" ng-show="child._open" data-ez-file-tree="true"></div></li></ul>';var k=function(a){a.child._active=!0,"undefined"!=typeof a.$parent.child&&k(a.$parent)},l=function(b){var c=!1;a.forEach(b.child[j],function(a){a._checked===!0&&(c=!0)}),b.child._active=c,c===!1&&b.$parent.child&&b.$parent.child[j]&&l(b.$parent)};d.check=function(a){a._checked?k(d):l(d)};var m=function(b){a.forEach(b,function(a){a.children&&a.children.length&&m(a.children),a.selected=!1})};d.select=function(a){i===!1&&a._selected&&m(d.folder.children),a._selected=!a._selected},d.toggle=function(a,b){a.stopPropagation(),a.preventDefault(),d.isFolder(b)&&(b._open=!b._open,b[j]||(b[j]=d.getChildren(b)))},d.isFolder=function(a){return a[j]||"folder"===a.type};var n=a.element(g);b(n)(d),e.append(n)}}}])}(angular);