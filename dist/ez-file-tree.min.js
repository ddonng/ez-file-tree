!function(a){"use strict";a.module("ez.fileTree",[]).constant("EzFileTreeConfig",{chevronRightIconClass:"icon-chevron-right",chevronDownIconClass:"icon-chevron-down",folderIconClass:"icon-folder-close",fileIconClass:"icon-file",nameField:"name",childrenField:"children",checking:!1,multiSelect:!1}).directive("ezFileTree",["$compile","EzFileTreeConfig",function(b,c){return{restrict:"EA",link:function(d,e,f){var g,h="true"===f.checking?!0:c.checking,i=f.nameField||c.nameField,j=f.childrenField||c.childrenField,k="true"===f.multiSelect?!0:c.multiSelect;d.child||(d.child=d.$eval(f.ezFileTree)),g='<ul class="ez-file-tree"><li data-ng-show="child.'+j+" && child."+j+'.length == 0">empty</li><li ng-repeat="child in child.'+j+'" data-ng-dblclick="toggle($event, child)"><div class="label-container" ng-class="{selected: child._selected}"><span class="folder-toggle" data-ng-click="toggle($event, child)"><i class="'+c.chevronRightIconClass+'" title="Open folder" data-ng-show="!child._open && isFolder(child)"></i><i class="'+c.chevronDownIconClass+'" title="Close folder" data-ng-show="child._open && isFolder(child)"></i></span>',h&&(g+='<input type="checkbox" ng-model="child._checked" ng-change="check(child)" data-ng-show="!isFolder(child)"/>'),g+='<span class="file-name" data-ng-click="select(child)"><i class="'+c.folderIconClass+'" data-ng-show="isFolder(child)"></i><i class="'+c.fileIconClass+'" data-ng-show="!isFolder(child)"></i><span>{{child.'+i+'}}</span></span></div><div class="folder-container" ng-show="child._open" data-ez-file-tree="true" data-checking="'+h+'" data-multi-select="'+k+'"></div></li></ul>';var l=function(a){a.child._active=!0,"undefined"!=typeof a.$parent.child&&l(a.$parent)},m=function(b){var c=!1;a.forEach(b.child[j],function(a){a._checked===!0&&(c=!0)}),b.child._active=c,c===!1&&b.$parent.child&&b.$parent.child[j]&&m(b.$parent)};d.check=function(a){a._checked?l(d):m(d)};var n=function(b){a.forEach(b,function(a){a[j]&&a[j].length&&n(a[j]),a._selected=!1})};d.select=function(a){console.log("select"),a._selected?(a._selected=!1,k?d.folder._selectedFiles.splice(d.folder._selectedFiles.indexOf(a),1):d.folder._selectedFile=null):(k?d.folder._selectedFiles.push(a):(d.folder._selectedFile=a,n(d.folder[j])),a._selected=!0)},d.toggle=function(a,b){a.stopPropagation(),a.preventDefault(),d.isFolder(b)&&(b._open=!b._open,b[j]||(b[j]=d.getChildren(b)))},d.isFolder=function(a){return"folder"===a.type||"album"===a.type};var o=a.element(g);b(o)(d),e.append(o)}}}])}(angular);